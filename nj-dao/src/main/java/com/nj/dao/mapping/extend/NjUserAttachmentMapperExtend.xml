<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nj.dao.extend.NjUserAttachmentMapperExtend">
    <resultMap id="BaseResultMap" type="com.nj.model.generate.NjUserAttachment">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Jul 26 15:14:40 CST 2017.
        -->
        <id column="id" jdbcType="VARCHAR" property="id"/>
        <result column="version" jdbcType="INTEGER" property="version"/>
        <result column="file_tag" jdbcType="VARCHAR" property="fileTag"/>
        <result column="file_name" jdbcType="VARCHAR" property="fileName"/>
        <result column="file_path" jdbcType="VARCHAR" property="filePath"/>
        <result column="file_size" jdbcType="VARCHAR" property="fileSize"/>
        <result column="file_type" jdbcType="VARCHAR" property="fileType"/>
        <result column="is_temp" jdbcType="BIT" property="isTemp"/>
        <result column="business_type" jdbcType="INTEGER" property="businessType"/>
        <result column="channel" jdbcType="INTEGER" property="channel"/>
        <result column="bussness_id" jdbcType="VARCHAR" property="bussnessId"/>
        <result column="del_flag" jdbcType="BIT" property="delFlag"/>
        <result column="create_date" jdbcType="TIMESTAMP" property="createDate"/>
        <result column="create_by" jdbcType="VARCHAR" property="createBy"/>
        <result column="update_date" jdbcType="TIMESTAMP" property="updateDate"/>
        <result column="update_by" jdbcType="VARCHAR" property="updateBy"/>
        <result column="source" jdbcType="VARCHAR" property="source"/>
    </resultMap>
    <select id="getFaceIdImageUrl" parameterType="java.lang.String"
            resultType="java.lang.String">
		SELECT njua.file_path AS url
		FROM nj_loan_order njlo
		INNER JOIN nj_order_attachment njla ON njlo.id = njla.order_id
		INNER JOIN nj_user_attachment njua ON (
			njla.attach_id = njua.id
			AND njua.business_type = 9003
			)
		WHERE njlo.id = #{orderId, jdbcType=VARCHAR}
		ORDER BY njua.create_date DESC limit 0
			,1
	</select>

    <select id="getHeadImageUrl" parameterType="java.lang.String"
            resultType="java.lang.String">
		SELECT file_path AS url
		FROM nj_user_attachment
		WHERE business_type = 9001
			AND bussness_id = #{userId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>


    <select id="getHandCertImageUrl" parameterType="java.lang.String"
            resultType="java.lang.String">
		SELECT file_path AS url
		FROM nj_user_attachment
		WHERE business_type = 8003
			AND bussness_id = #{userId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>

    <select id="getHandCertImage" parameterType="java.lang.String"
            resultMap="BaseResultMap">
		SELECT *
		FROM nj_user_attachment
		WHERE business_type = 9007
			AND bussness_id = #{userId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>

    <select id="getHeadImage" parameterType="java.lang.String"
            resultMap="BaseResultMap">
		SELECT *
		FROM nj_user_attachment
		WHERE business_type = 9001
			AND bussness_id = #{userId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>

    <select id="getEmblemImage" parameterType="java.lang.String"
            resultMap="BaseResultMap">
		SELECT *
		FROM nj_user_attachment
		WHERE business_type = 9002
			AND bussness_id = #{userId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>

    <select id="getEmblemImageUrl" parameterType="java.lang.String"
            resultType="java.lang.String">
		SELECT file_path AS url
		FROM nj_user_attachment
		WHERE business_type = 9002
			AND bussness_id = #{userId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>

    <select id="getAttachByOrderId" parameterType="java.lang.String"
            resultMap="BaseResultMap">
		SELECT *
		FROM nj_user_attachment njua
		INNER JOIN nj_order_attachment njla ON njua.id = njla.attach_id
		WHERE business_type =  #{businessType, jdbcType=VARCHAR}
			AND njla.order_id = #{orderId, jdbcType=VARCHAR}
		ORDER BY create_date DESC limit 0
			,1
	</select>

</mapper>